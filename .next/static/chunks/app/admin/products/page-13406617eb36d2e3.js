(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7575],{553:(e,t,a)=>{Promise.resolve().then(a.bind(a,9991))},9991:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(5155),l=a(2115),r=a(2619),i=a.n(r);let c=["DISALLOW","ALLOW"],n={name:"",slug:"",description:"",type:"",gender:"",sport:"",categoryId:"",collectionId:"",basePriceEur:"",isActive:!0,isFeatured:!1,backorderPolicy:"DISALLOW"};function d(){let[e,t]=(0,l.useState)([]),[a,r]=(0,l.useState)([]),[d,o]=(0,l.useState)([]),[x,p]=(0,l.useState)(!0),[u,h]=(0,l.useState)(null),[m,g]=(0,l.useState)({...n}),[b,j]=(0,l.useState)(null),[f,v]=(0,l.useState)(null),[y,N]=(0,l.useState)({}),w=async()=>{p(!0);let[e,a,s]=await Promise.all([fetch("/api/admin/products",{credentials:"include"}),fetch("/api/admin/collections",{credentials:"include"}),fetch("/api/admin/categories",{credentials:"include"})]);if(!e.ok){h("Failed to load products."),p(!1);return}let l=await e.json(),i=a.ok?await a.json():{data:[]},c=s.ok?await s.json():{data:[]};t(l.data||[]),r(i.data||[]),o(c.data||[]),p(!1)};(0,l.useEffect)(()=>{w()},[]);let k=()=>{g({...n}),j(null)},C=async()=>{h(null);let e={...m,basePriceEur:""===m.basePriceEur?void 0:Number(m.basePriceEur),categoryId:m.categoryId||null,collectionId:m.collectionId||null},t=await fetch(b?"/api/admin/products/".concat(b):"/api/admin/products",{method:b?"PATCH":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"});if(!t.ok){let e=await t.json().catch(()=>null);h((null==e?void 0:e.error)||"Save failed.");return}k(),w()},E=e=>{N(t=>{if(!t[e])return t;let a={...t};return delete a[e],a})},P=(e,t)=>{N(a=>({...a,[e]:t}))},S=async(e,t)=>{if(t&&0!==t.length){E(e),v(e);try{for(let a of Array.from(t)){if(!a.type.startsWith("image/")){P(e,"Only image uploads are supported.");continue}let t=await fetch("/api/admin/media/presign",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({entityType:"product",entityId:e,fileName:a.name,contentType:a.type})});if(!t.ok){let e=await t.json().catch(()=>null);throw Error((null==e?void 0:e.error)||"Failed to prepare upload.")}let{uploadUrl:s,objectKey:l,bucket:r}=await t.json();if(!(await fetch(s,{method:"PUT",headers:{"Content-Type":a.type},body:a})).ok)throw Error("Upload failed.");let i=await fetch("/api/admin/media",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({entityType:"product",entityId:e,objectKey:l,bucket:r,mimeType:a.type})});if(!i.ok){let e=await i.json().catch(()=>null);throw Error((null==e?void 0:e.error)||"Failed to save media.")}}}catch(t){P(e,t.message)}finally{v(t=>t===e?null:t),w()}}},I=async(e,t)=>{confirm("Remove this image?")&&(await fetch("/api/admin/media/".concat(e),{method:"DELETE",credentials:"include"}),w(),E(t))},T=async e=>{confirm("Delete this product?")&&(await fetch("/api/admin/products/".concat(e),{method:"DELETE",credentials:"include"}),w())},A=(0,l.useMemo)(()=>b?"Edit Product":"Create Product",[b]);return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"font-bebas text-5xl",children:"Products"}),(0,s.jsx)("p",{className:"text-slate-400",children:"Create items, assign categories and collections."})]}),(0,s.jsx)(i(),{href:"/admin",className:"text-sm uppercase tracking-[0.2em] text-slate-400 hover:text-gold",children:"Back to Admin"})]}),(0,s.jsxs)("section",{className:"border border-white/10 bg-slate-900/60 p-6",children:[(0,s.jsx)("h2",{className:"font-bebas text-2xl mb-4",children:A}),u&&(0,s.jsx)("p",{className:"text-sm text-red-400 mb-3",children:u}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Name"}),(0,s.jsx)("input",{value:m.name,onChange:e=>g({...m,name:e.target.value}),className:"w-full bg-slate-950 border border-white/10 px-4 py-3 text-white focus:outline-none focus:border-gold"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Slug"}),(0,s.jsx)("input",{value:m.slug,onChange:e=>g({...m,slug:e.target.value}),className:"w-full bg-slate-950 border border-white/10 px-4 py-3 text-white focus:outline-none focus:border-gold"})]}),(0,s.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,s.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Description"}),(0,s.jsx)("textarea",{value:m.description,onChange:e=>g({...m,description:e.target.value}),className:"w-full bg-slate-950 border border-white/10 px-4 py-3 text-white focus:outline-none focus:border-gold",rows:3})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Type"}),(0,s.jsx)("input",{value:m.type,onChange:e=>g({...m,type:e.target.value}),className:"w-full bg-slate-950 border border-white/10 px-4 py-3 text-white focus:outline-none focus:border-gold"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Gender"}),(0,s.jsx)("input",{value:m.gender,onChange:e=>g({...m,gender:e.target.value}),className:"w-full bg-slate-950 border border-white/10 px-4 py-3 text-white focus:outline-none focus:border-gold"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Sport"}),(0,s.jsx)("input",{value:m.sport,onChange:e=>g({...m,sport:e.target.value}),className:"w-full bg-slate-950 border border-white/10 px-4 py-3 text-white focus:outline-none focus:border-gold"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Category"}),(0,s.jsxs)("select",{value:m.categoryId,onChange:e=>g({...m,categoryId:e.target.value}),className:"w-full bg-slate-950 border border-white/10 px-4 py-3 text-white",children:[(0,s.jsx)("option",{value:"",children:"None"}),d.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Collection"}),(0,s.jsxs)("select",{value:m.collectionId,onChange:e=>g({...m,collectionId:e.target.value}),className:"w-full bg-slate-950 border border-white/10 px-4 py-3 text-white",children:[(0,s.jsx)("option",{value:"",children:"Always-on (none)"}),a.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Base Price (EUR)"}),(0,s.jsx)("input",{type:"number",value:m.basePriceEur,onChange:e=>g({...m,basePriceEur:e.target.value}),className:"w-full bg-slate-950 border border-white/10 px-4 py-3 text-white focus:outline-none focus:border-gold"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Backorder"}),(0,s.jsx)("select",{value:m.backorderPolicy,onChange:e=>g({...m,backorderPolicy:e.target.value}),className:"w-full bg-slate-950 border border-white/10 px-4 py-3 text-white",children:c.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{type:"checkbox",checked:m.isActive,onChange:e=>g({...m,isActive:e.target.checked}),className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm text-slate-300",children:"Active"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{type:"checkbox",checked:m.isFeatured,onChange:e=>g({...m,isFeatured:e.target.checked}),className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm text-slate-300",children:"Featured"})]})]}),(0,s.jsxs)("div",{className:"mt-6 flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:C,className:"px-6 py-3 bg-gold text-slate-950 font-barlow font-bold uppercase tracking-wider text-sm hover:bg-white transition-colors",children:b?"Save Changes":"Create Product"}),b&&(0,s.jsx)("button",{onClick:k,className:"text-sm uppercase tracking-[0.2em] text-slate-400 hover:text-white",children:"Cancel"})]})]}),(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"font-bebas text-2xl",children:"Existing Products"}),x?(0,s.jsx)("p",{className:"text-slate-400",children:"Loading products..."}):(0,s.jsx)("div",{className:"space-y-4",children:e.map(e=>{var t,a,l;return(0,s.jsxs)("div",{className:"border border-white/10 bg-slate-900/40 p-4 flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bebas text-xl",children:e.name}),(0,s.jsx)("p",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:e.slug}),(0,s.jsxs)("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-400",children:[(0,s.jsxs)("span",{children:["EUR ",e.basePriceEur]}),(0,s.jsx)("span",{children:"•"}),(0,s.jsx)("span",{children:(null==(t=e.collection)?void 0:t.name)||"Always-on"}),(0,s.jsx)("span",{children:"•"}),(0,s.jsxs)("span",{children:[null!=(l=null==(a=e.variants)?void 0:a.length)?l:0," variants"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:()=>{var t,a,s,l,r;j(e.id),g({name:e.name||"",slug:e.slug||"",description:e.description||"",type:e.type||"",gender:e.gender||"",sport:e.sport||"",categoryId:(null==(t=e.category)?void 0:t.id)||"",collectionId:(null==(a=e.collection)?void 0:a.id)||"",basePriceEur:(null==(s=e.basePriceEur)?void 0:s.toString())||"",isActive:null==(l=e.isActive)||l,isFeatured:null!=(r=e.isFeatured)&&r,backorderPolicy:e.backorderPolicy||"DISALLOW"})},className:"px-4 py-2 border border-white/10 text-xs uppercase tracking-[0.2em] hover:border-gold",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>T(e.id),className:"px-4 py-2 border border-red-500/40 text-xs uppercase tracking-[0.2em] text-red-300 hover:border-red-400",children:"Delete"})]})]}),(0,s.jsxs)("div",{className:"border-t border-white/10 pt-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsx)("span",{className:"text-xs uppercase tracking-[0.2em] text-slate-500",children:"Images"}),(0,s.jsxs)("label",{className:"px-4 py-2 border border-white/10 text-xs uppercase tracking-[0.2em] text-slate-200 hover:border-gold cursor-pointer",children:[f===e.id?"Uploading...":"Upload Images",(0,s.jsx)("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",disabled:f===e.id,onChange:t=>{let a=t.currentTarget.files;t.currentTarget.value="",S(e.id,a)}})]})]}),y[e.id]&&(0,s.jsx)("p",{className:"mt-3 text-xs text-red-400",children:y[e.id]}),(0,s.jsx)("div",{className:"mt-4 flex flex-wrap gap-3",children:e.media&&e.media.length>0?e.media.map(t=>(0,s.jsxs)("div",{className:"relative h-20 w-20 overflow-hidden border border-white/10 bg-slate-950",children:[t.url?(0,s.jsx)("img",{src:t.url,alt:t.alt||e.name,className:"h-full w-full object-cover"}):(0,s.jsx)("div",{className:"h-full w-full flex items-center justify-center text-[10px] text-slate-500",children:"No preview"}),(0,s.jsx)("button",{onClick:()=>I(t.id,e.id),className:"absolute top-1 right-1 bg-slate-950/80 text-white text-[10px] px-1 py-0.5 border border-white/10 hover:border-red-400",children:"x"})]},t.id)):(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"No images yet."})})]})]},e.id)})})]})]})}}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=553)),_N_E=e.O()}]);